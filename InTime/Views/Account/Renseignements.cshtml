@model InTime.Models.RegisterModel

@{
    ViewBag.Title = "Renseignements";
}

<div>
    @{
        if (ViewBag.Message == InTime.Models.RequeteSql.Message.Reussi)
        {
            <h2><font color="green">Vos renseignements ont été modifiés </font></h2>
        }
        if (ViewBag.Message == InTime.Models.RequeteSql.Message.Echec)
        {
            <h2><font color="red">Une erreur s'est produite. Vos modifications n'ont pas été sauvegardées.</font></h2>
        }
    }
</div>

<ol class="breadcrumb">
    <li>@Html.ActionLink("Accueil", "Index", "Home")</li>
    <li>@Html.ActionLink("Tâches", "TacheForm", "Tache")</li>
    <li>@Html.ActionLink("Gérer Compte", "Index", "GererCompte")</li>
    <li class="active">Modifier vos renseignements personnels</li>
</ol>
<h2>Vos renseignements personnels</h2>
@{
    var information = (InTime.Models.RegisterModel)ViewData["utilisateur"];
}

@Html.ValidationSummary("Vous devez corriger les erreurs suivantes :")

@using (Html.BeginForm())
{
    <article>
        <p>
            Votre prénom :
            <br />
            @Html.TextBoxFor(model => model.Prenom, new { Value = information.Prenom ?? "", id = "Consultation" })
            @Html.ValidationMessageFor(model => model.Prenom, "*")
            <br />
            Votre nom :
            <br />
            @Html.TextBoxFor(model => model.Nom, new { Value = information.Nom ?? "", id = "Consultation" })
            @Html.ValidationMessageFor(model => model.Nom, "*")
            <br />
            Votre adresse courriel :
            <br />
            @Html.TextBoxFor(model => model.Email, new { Value = information.Email ?? "", id = "Consultation" })
            @Html.ValidationMessageFor(model => model.Email, "*")
        </p>
        <form name="frmlistbox">
            <p>
                Usage principal de votre calendirer:
                <select name="choixcategories">
                    <option selected="selected" disabled="disabled">@information.Categorie</option>
                    <option value="Travail">Travail</option>
                    <option value="École">École</option>
                    <option value="Général">Général</option>
                </select>
            </p>
        </form>
        <p>
            <div style="display:inline-block">
                <input id="Sauv" type="submit" value="Sauvegarder" />
                <input id="Mod" type="button" value="Modifier vos renseignements" style="display:none" />
                <input type="button" value="Retour" onclick="location.href = '@Url.Action("TacheForm","Tache",null)'" />
            </div>
            <br/>
            <br/>
            <input type="button" value="Modifier votre mot de passe" onclick="location.href = '@Url.Action("Manage","Account",null)'" />
        </p>
    </article>
}

@if (ViewBag.Affichage == 1)
{
    <script>
        $("#Sauv").css("display", "none");
        $("#Mod").css("display", "inherit");
        $("[id^=Consultation").attr('readonly', 'true');
        $("[id^=Consultation").css('background-color', '#DEDEDE');
        $("#Mod").click(function () {
            $("[id^=Consultation").removeAttr('readonly');
            $("[id^=Consultation").css('background-color', 'white');
            $("#Sauv").css("display", "inherit");
            $("#Mod").css("display", "none");
            var listbox = $('select[name="choixcategories"]');
            listbox.prop('disabled', false);
            
        });
        $(function () {
            var listbox = $('select[name="choixcategories"]');
            listbox.prop('disabled', true);
        });
    </script>
}
